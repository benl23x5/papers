\documentclass[a4paper,11pt]{book}

% -- setup
\usepackage{style/setup}

\begin{document}

% -- Title --------------------------------------
\begin{titlepage}
\begin{center}
\vspace*{\fill}
\Huge Type Inference and Optimisation 
	\\ for an Impure World.
\\
\vfill\vfill
\Large Ben Lippmeier
\\
\vfill\vfill
	DRAFT
\\
	June, 2009
\\
\vfill\vfill 
\normalsize
      A thesis submitted for the degree of Doctor of Philosophy\\
      of the Australian National University
\vfill
      \includegraphics{ANU.eps}
\end{center}

\end{titlepage}


% \title		
% {	Type Inference and Optimisation 
% 	\\ for an Impure World.}
% \author	{Ben Lippmeier}
% \date	{April, 2009}
%
% \maketitle


% -- Declaration ------------------------------------
\chapter*{Declaration}\label{declaration}
\thispagestyle{empty}
The work in this thesis is my own except where otherwise stated.

\vspace{1in}

\hfill\hfill\hfill
%
Ben Lippmeier
%
\hspace*{\fill}

% -- Acknowledgements --------------------------------
\chapter*{Thanks}\label{acknowledgements}
\addcontentsline{toc}{chapter}{Thanks}

Thanks to my family and friends for putting up with me and my occasional disappearances.

Sincere thanks to my supervisor Clem Baker-Finch, to Simon Marlow for an internship at GHC HQ, and to Bernie Pope for reading draft versions of this thesis.

Shouts out to the fp-syd crew, for pleasant monthly diversions when I probably should have been writing up instead.

Thanks to the General, the Particular and FRATER PERDURABO, who taught me that great truths are also great lies.

Thanks to the people who receive no thanks.

All Hail Discordia.


% -- Abstract --------------------------------------
\chapter*{Abstract}\label{abstract}
\addcontentsline{toc}{chapter}{Abstract}

We address the problem of reasoning about the behaviour of functional programs that use destructive update and other side effecting actions. All general purpose languages must support such actions, but adding them in an undisciplined manner destroys the nice algebraic properties that compiler writers depend on to transform code.

We present a type based mutability, effect and data sharing analysis for reasoning about such programs. Our analysis is based on a combination of Talpin and Jouvelot's type and effect discipline, and Leroy's closure typing system. The extra information is added to our System-F style core language and we use it to guide code transformation optimisations similar to those implemented in GHC. We use a type classing mechanism to express constraints on regions, effects and closures and show how these constraints can be represented in the same way as the type equality constraints of System-Fc. 

We use type directed projections to express records and to eliminate need for ML style mutable references. Our type inference algorithm extracts type constraints from the desugared source program, then solves them by building a type graph. This multi-staged approach is similar to that used by the Helium Haskell compiler, and the type graph helps to manage the effect and closure constraints of recursive functions. 

Our language uses call-by-value evaluation by default, but allows the seamless integration of call-by-need. We use our analysis to detect when the combination of side effects and call-by-need evaluation would yield a result different from the call-by-value case. We contrast our approach with several other systems, and argue that it is more important for a compiler to be able to reason about the behaviour of a program, than for the language to be purely functional in a formal sense.

As opposed to using source level state monads, effect typing allows the programmer to offload the task of maintaining the intended sequence of effects onto the compiler. This helps to separate the conceptually orthogonal notions of value and effect, and reduces the need to refactor existing code when developing programs. We discuss the Disciplined Disciple Compiler (DDC), which implements our system, along with example programs and opportunities for future work.

% -- Layout -----------------------------------------
\chapter*{Layout}
\addcontentsline{toc}{chapter}{Layout}

The layout and formatting of this thesis was influenced by the work of Edward R. Tufte, especially his book ``Visual Explanations''. To reduce the need for the reader to flip pages back and forth when progressing through the material, I have avoided using floating figures, and have tried to keep related diagrams and discussion on the same two page spread. For this reason some diagrams have been repeated, and some sections contain extra white space.


% -- Contents ---------------------------------------
\tableofcontents


% -- Chapters --------------------------------------------
\include{1-Introduction/Main}
\include{2-System/Main}
\include{3-Inference/Main}
\include{4-Core/Main}
\include{5-Conclusion/Main}

% -- bibliography
\bibliography{bib/a,bib/b,bib/c,bib/d,bib/e,bib/f,bib/g,bib/h,bib/i,bib/j,bib/k,bib/l,bib/m,bib/n,bib/o,bib/p,bib/q,bib/r,bib/s,bib/t,bib/u,bib/v,bib/w,bib/x,bib/y,bib/z}{}
\bibliographystyle{amsalpha}

\include{6-Appendix/Main}

\end{document}
